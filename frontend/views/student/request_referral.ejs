<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Request Referral</title>
  <link rel="stylesheet" href="/css/style.css" />
  <style>
    .form-container {
      max-width: 480px;
      margin: 30px auto;
      padding: 28px;
      background: #fff;
    }

    .form-title {
      text-align: center;
      font-size: 1.6rem;
      margin-bottom: 24px;
    }

    .form-group {
      display: flex;
      gap: 12px;
      align-items: center;
      margin-bottom: 14px;
    }

    .form-group label {
      flex: 0 0 30%;
      font-weight: 500;
    }

    .form-group input,
    .form-group select {
      flex: 1;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 5px;
      background: #f5f5f5;
    }

    .actions {
      text-align: center;
      margin-top: 24px;
    }

    .btn-secondary {
      background: #0d6efd;
      margin-top: 12px;
    }

    .message {
      text-align: center;
      padding: 10px;
      border-radius: 5px;
      margin-bottom: 14px;
      font-weight: 500;
    }

    .message-error {
      background: #f8d7da;
      color: #721c24;
    }

    .message-success {
      background: #d4edda;
      color: #155724;
    }
  </style>
</head>

<body>
  <%- include('../partials/header', { navHtml: '<a href="/logout" class="btn">LOG OUT</a>' }) %>
    <main class="main-content">
      <div class="form-container">
        <h2 class="form-title">Request Referral</h2>
        <% if (typeof error !=='undefined' && error) { %>
          <p class="message message-error">
            <%= error %>
          </p>
          <% } %>
            <% if (typeof success !=='undefined' && success) { %>
              <p class="message message-success">
                <%= success %>
              </p>
              <% } %>
                <form action="/request-referral" method="POST">
                  <div class="form-group">
                    <label for="problem">Problem</label>
                    <input type="text" id="problem" name="problem" required />
                  </div>
                  <div class="form-group">
                    <label for="doctor_id">Doctor</label>
                    <select id="doctor_id" name="doctor_id" required>
                      <option value="" disabled selected>Select</option>
                      <% (doctors||[]).forEach(doc=> { %>
                        <option value="<%= doc.id %>">
                          <%= doc.name %>
                        </option>
                        <% }) %>
                    </select>
                  </div>
                  <div class="form-group">
                    <label for="date">Date</label>
                    <input type="date" id="date" name="date" required />
                  </div>
                  <div class="form-group">
                    <label for="time">Time</label>
                    <input type="time" id="time" name="time" required />
                  </div>
                  <div class="actions">
                    <button type="submit" class="btn">Request</button><br />
                    <a href="/users/<%= userid %>" class="btn btn-secondary">Back to Dashboard</a>
                  </div>
                </form>
      </div>
    </main>
    <%- include('../partials/footer') %>
</body>

</html>